	PROGRAM I2LINES2
c  this program previously called assignlinera2.f
c  4/4/96 changed array limits from 3000 to 50000
C  LAST REVISIONS MADE ON 10/8/93 BY J. FORKEY, MAE, PRINCETON UNIVERSITY.
C  THIS PROGRAM USES THE MOLECULAR CONSTANTS AND FRANCK CONDON FACTORS 
C  TABULATED IN THE PUBLICATION "IDENTIFICATION DES TRANSITIONS DU SYSTEME
C  (B-X) DE LA MOLECULE D'IODE ET FACTEURS DE FRANCK-CONDON 14000-15600 CM-1"
C  BY S. GERSTENKORN, AND P. LUC (PUBLISHED BY LABORATOIRE AIME - COTTON 
C  C.N.R.S. II 91405 ORSAY, FRANCE, 1986).  THE DATA FILE OF FRANCK-CONDON
C  FACTORS (fcfioded) WAS PROVIDED BY P. LUC
C  THE POSITIONS OF ALL OF THE LINES PREDICTED BETWEEN WNLO AND WNHI 
C  WAVENUMBERS ARE CALCULATED AND SAVED TO THE FILE FILNAM
C  TRANSITIONS CONSIDERED ARE THOSE THAT HAVE LOWER LEVEL J VALUE - KJ - 
C  BETWEEN 0 AND 200 (OR THE LIMIT DETERMINED BY THE UPPER LEVEL DISSOCIATION
C  LIMIT), AND THAT HAVE UPPER LEVEL V - KVU - BETWEEN 0 AND 69, AND THAT HAVE 
C  LOWER LEVEL V - KVL - BETWEEN 0 AND 19.

	INTEGER IVL,IVU,J,KVU(1:50000),KVL(1:50000),KJ(1:50000),
     &		JMAX(0:69),LJ,LJFMAX(0:69),M,NC
	DOUBLE PRECISION EU(0:69),BU(0:69),DU(0:69),
     &                   HU(0:69),LU(0:69),MU(0:69),
     &			 EL(0:19),BL(0:19),DL(0:19),HL(0:19),
     &                   ER(0:69,0:19,0:200),
     &                   EP(0:69,0:19,0:200),
     &			 FACTOR(0:69,0:19,0:8),EXP,
     &			 ENERGY(1:50000),FCF(1:50000),
     &			 OLDEN,CURENTEN,
     &			 WNLO,WNHI,
     &			 GU,EROT,ETOT
	REAL DELTAEQQ(1:50000),DELTAC(1:50000) 
	CHARACTER*1 RORP(50000)
	CHARACTER*20 FILNAM

	WRITE(6,5)
5	FORMAT('ENTER LOW WAVENUMBER [CM-1]')
	READ(5,*)WNLO
	WRITE(6,6)
6	FORMAT('ENTER HIGH WAVENUMBER [CM-1]')
	READ(5,*)WNHI
	WRITE(6,7)
7	FORMAT('ENTER DATA FILE NAME')
	READ(5,8)FILNAM
8	FORMAT(A20)

C
C  STORE VALUES FOR MOLECULAR CONSTANTS
	DATA EL /0.0000, 213.3023, 425.3742, 636.2103, 845.8034,
     &           1054.1456, 1261.2284, 1467.0428, 1671.5796, 1874.8295,
     &           2076.7829, 2277.4300, 2476.7606, 2674.7643, 2871.4302,
     &           3066.7470, 3260.7032, 3453.2871, 3644.4874, 3834.2932/
	DATA BL /0.3731114098671146, 0.3719670067802829, 
     &  0.3708161358474350, 0.3696585853818199, 0.3684941526048041,
     &  0.3673226380482058,
     &  0.3661438399566286, 0.3649575486897959, 0.3637635411248850,
     &	0.3625615750588612, 0.3613513836108117, 0.3601326696242798,
     &	0.3589051000695991, 0.3576683004462275, 0.3564218491850814,
     &  0.3551652720508696, 0.3538980365444274, 0.3526195463050510,
     &	0.3513291355128313, 0.3500260632909881/
	DATA DL /0.4547547628207550, 0.4572208485138791, 
     &  0.4597534338572310, 0.4623730064958022, 0.4650910671516871,
     &  0.4679135797367788,
     &	0.4708437425553093, 0.4738840805962359, 0.4770378589154716,
     &	0.4803098171079618, 0.4837062248696054, 0.4872342586490214,
     &	0.4909006993891605, 0.4947099513587618, 0.4986613820736552,
     &	0.5027459833079082, 0.5069423531948184, 0.5112119994177510,
     &	0.5154939634908213, 0.519698766129423/
	DATA HL /0.5127518681623231, 0.5340322291154361, 
     &  0.5556429468721693, 0.5779567669609448, 0.6012238577098949,
     &  0.6256071108097138, 0.6512174418765087, 0.6781490910146517,
     &  0.7065149233796305, 0.7364817297409003, 0.7683055270447346,
     &  0.8023668589770773, 0.8392060965263935, 0.8795587385465209,
     &  0.9243907123195214,
     &  0.9749336741185324, 1.032720309770618, 1.099619635219621,
     &  1.177872297089012, 1.270125873244745/
	DATA EU /15724.5871, 15848.7424, 15971.3641, 16092.4323, 
     &  16211.9276,
     &  16329.8305, 16446.1208, 16560.7781, 16673.7813, 16785.1091,
     &  16894.7398, 17002.6518, 17108.8231, 17213.2315, 17315.8550,
     &  17416.6714, 17515.6584, 17612.7938, 17708.0558, 17801.4224,
     &  17892.8722, 17982.3842, 18069.9377, 18155.5130, 18239.0911,
     &  18320.6538, 18400.1843, 18477.6669, 18553.0874, 18626.4332,
     &  18697.6935, 18766.8595, 18833.9246, 18898.8844, 18961.7370,
     &  19022.4833, 19081.1269, 19137.6741, 19192.1344, 19244.5204,
     &  19294.8475, 19343.1343, 19389.4024, 19433.6763, 19475.9832,
     &  19516.3530, 19554.8181, 19591.4129, 19626.1741, 19659.1400,
     &  19690.3504, 19719.8466, 19747.6709, 19773.8664, 19798.4772,
     &  19821.5480, 19843.1241, 19863.2512, 19881.9758, 19899.3449,
     &  19915.4059, 19930.2072, 19943.7980, 19956.2281, 19967.5484,
     &  19977.8108, 19987.0680, 19995.3737, 20002.7823, 20009.3488/
	DATA BU /0.289256971, 0.287738074, 0.286194827, 0.284626516,
     &		 0.283032072, 0.281410363, 0.279760289, 0.278080789,
     &		 0.276370807, 0.274629252, 0.272854969, 0.271046725,
     &		 0.269203212, 0.267323056, 0.265404834, 0.263447094,
     &		 0.261448373, 0.259407207, 0.257322139, 0.255191724,
     &		 0.253014530, 0.250789133, 0.248514120, 0.246188084,
     &		 0.243809635, 0.241377401, 0.238890046, 0.236346284,
     &		 0.233744900, 0.231084776, 0.228364917, 0.225584470,
     &		 0.222742758, 0.219839290, 0.216873785, 0.213846178,
     &		 0.210756623, 0.207605493, 0.204393366, 0.201121013,
     &		 0.197789367, 0.194399505, 0.190952609, 0.187449932,
     &		 0.183892767, 0.180282407, 0.176620109, 0.172907068,
     &		 0.169144381, 0.165333029, 0.161473851, 0.157567537,
     &		 0.153614614, 0.149615449, 0.145570257, 0.141479115,
     &		 0.137341988, 0.133158765, 0.128929309, 0.124653511,
     &		 0.120331372, 0.115963080, 0.111549116, 0.107090361,
     &		 0.102588207, 0.980446757, 0.934625284, 0.888453519,
     &		 0.841976193, 0.795247025/
	DATA DU /0.623184071, 0.634498863, 0.646390069, 0.658936697,
     &		 0.672194237, 0.686208169, 0.701022026, 0.716681823,
     &		 0.733238172, 0.750747024, 0.769269693, 0.788872567,
     &		 0.809626788, 0.831608011, 0.854896312, 0.879576237,
     &		 0.905736950, 0.933472447, 0.962881752, 0.994069070,
     &		 0.102714384, 0.106222064, 0.109941901, 0.113886305,
     &		 0.118068096, 0.122500445, 0.127196813, 0.132170885,
     &		 0.137436522, 0.143007709, 0.148898547, 0.155123256,
     &		 0.161696229, 0.168632122, 0.175946007, 0.183653576,
     &		 0.191771415, 0.200317341, 0.209310816, 0.218773428,
     &		 0.228729448, 0.239206455, 0.250236030, 0.261854525,
     &		 0.274103892, 0.287032577, 0.300696490, 0.315160040,
     &		 0.330497240, 0.346792900, 0.364143905, 0.382660587,
     &		 0.402468213, 0.423708590, 0.446541820, 0.471148212,
     &		 0.497730397, 0.526515687, 0.557758756, 0.591744750,
     &		 0.628793001, 0.669261601, 0.713553235, 0.762122829,
     &		 0.815487852, 0.874242437, 0.939076958, 0.101080529,
     &		 0.109040280, 0.117905900/
	DATA HU /0.236059709, 0.255494386, 0.276699292, 0.299730171,
     &		 0.324712735, 0.351828987, 0.381305617, 0.413404624,
     &		 0.448416290, 0.486654557, 0.528454767, 0.574173652,
     &		 0.624191446, 0.678915959, 0.738788420, 0.804290883,
     &		 0.875954939, 0.954371438, 0.104020092, 0.113418442,
     &		 0.123715432, 0.135004496, 0.147390275, 0.160989561,
     &		 0.175932160, 0.192361681, 0.210436261, 0.230329254,
     &		 0.252229941, 0.276344336, 0.302896189, 0.332128328,
     &		 0.364304519, 0.399712054, 0.438665326, 0.481510676,
     &		 0.528632851, 0.580463410, 0.637491472, 0.700277217,
     &		 0.769468565, 0.845821533, 0.930224813, 0.102372922,
     &		 0.112758280, 0.124327264, 0.137257451, 0.151761224,
     &		 0.168092862, 0.186557087, 0.207519395, 0.231418646,
     &		 0.258782507, 0.290246517, 0.326577828, 0.368704986,
     &		 0.417755631, 0.475104663, 0.542436409, 0.621825688,
     &		 0.715844732, 0.827705783, 0.961453506, 0.112222770,
     &		 0.131662627, 0.155321297, 0.184323647, 0.220166265,
     &		 0.264867717, 0.321190625/
	DATA LU /0.301891905, 0.339067474, 0.382234284, 0.431548074,
     &		 0.487312647, 0.549996849, 0.620256031, 0.698953410,
     &		 0.787179347, 0.886268189, 0.997813192, 0.112368044,
     &		 0.126602265, 0.142729375, 0.161026496, 0.181804330,
     &		 0.205409358, 0.232226556, 0.262682841, 0.297251563,
     &		 0.336458409, 0.380889215, 0.431200222, 0.488131426,
     &		 0.552523731, 0.625340663, 0.707695536, 0.800885008,
     &		 0.906430138, 0.102612626, 0.116210323, 0.131689806,
     &		 0.149354233, 0.169566755, 0.192763252, 0.219467754,
     &		 0.250311205, 0.286054391, 0.327616067, 0.376107648,
     &		 0.432876190, 0.499557954, 0.578145519, 0.671072385,
     &		 0.781320317, 0.912556444, 0.106930958, 0.125719862,
     &		 0.148323046, 0.175619147, 0.208716555, 0.249022455,
     &		 0.298335492, 0.358971029, 0.433931657, 0.527140992,
     &		 0.643766649, 0.790669836, 0.977036282, 0.121526919,
     &		 0.152226450, 0.192124993, 0.244446499, 0.313711182,
     &		 0.406325388, 0.531474864, 0.702499197, 0.939045055,
     &		 0.127050903, 0.174167121/
	DATA MU /0.106365241, 0.118424920, 0.134878319, 0.156148979,
     &		 0.182822101, 0.215614715, 0.255362733, 0.303021172,
     &		 0.359676671, 0.426572538, 0.505146923, 0.597084729,
     &		 0.704383883, 0.829436694, 0.975127447, 0.114494794,
     &		 0.134313350, 0.157482286, 0.184624651, 0.216494888,
     &		 0.254005129, 0.298256361, 0.350575430, 0.412559046,
     &		 0.486126191, 0.573580707, 0.677686275, 0.801756694,
     &		 0.949765250, 0.112647822, 0.133761931, 0.159007402,
     &		 0.189214641, 0.225388451, 0.268749686, 0.320789002,
     &		 0.383336751, 0.458654473, 0.549555387, 0.659563941,
     &		 0.793128221, 0.955904190, 0.115513807, 0.140018365,
     &		 0.170320603, 0.208014494, 0.255204147, 0.314687716,
     &		 0.390214018, 0.486843002, 0.611455583, 0.773479699,
     &		 0.985931567, 0.126691964, 0.164183282, 0.214654816,
     &		 0.283217039, 0.377209285, 0.507261119, 0.688903221,
     &		 0.945038537, 0.130977838, 0.183447759, 0.259737387,
     &		 0.371924957, 0.538937621, 0.790944200, 0.117697738,
     &		 0.177852696, 0.273453277/
     
	  DO 10 IVL = 0,19
	    BL(IVL)=BL(IVL)*0.1
	    DL(IVL)=DL(IVL)*1.D-8
	    HL(IVL)=-HL(IVL)*1.D-15
	    
10    CONTINUE
	  DO 20 IVU = 0,69
	  IF (IVU.LE.64) THEN
	    BU(IVU)=BU(IVU)*0.1
	  ELSEIF ((IVU.GE.65).AND.(IVU.LE.69)) THEN
	    BU(IVU)=BU(IVU)*0.01
	  ENDIF
	  IF (IVU.LE.19) THEN
	    DU(IVU)=DU(IVU)*1.D-8
	  ELSEIF ((IVU.GE.20).AND.(IVU.LE.66)) THEN
	    DU(IVU)=DU(IVU)*1.D-7
	  ELSEIF ((IVU.GE.67).AND.(IVU.LE.69)) THEN
	    DU(IVU)=DU(IVU)*1.D-6
	  ENDIF
	  IF (IVU.LE.17) THEN
	    HU(IVU)=HU(IVU)*(-1.D-14)
	  ELSEIF ((IVU.GE.18).AND.(IVU.LE.42)) THEN
	    HU(IVU)=HU(IVU)*(-1.D-13)
	  ELSEIF ((IVU.GE.43).AND.(IVU.LE.62)) THEN
	    HU(IVU)=HU(IVU)*(-1.D-12)
	  ELSEIF ((IVU.GE.63).AND.(IVU.LE.69)) THEN
	    HU(IVU)=HU(IVU)*(-1.D-11)
	  ENDIF
	  IF (IVU.LE.10) THEN
	    LU(IVU)=LU(IVU)*(-1.D-20)
	  ELSEIF ((IVU.GE.11).AND.(IVU.LE.28)) THEN
	    LU(IVU)=LU(IVU)*(-1.D-19)
	  ELSEIF ((IVU.GE.29).AND.(IVU.LE.45)) THEN
	    LU(IVU)=LU(IVU)*(-1.D-18)
	  ELSEIF ((IVU.GE.46).AND.(IVU.LE.58)) THEN
	    LU(IVU)=LU(IVU)*(-1.D-17)
	  ELSEIF ((IVU.GE.59).AND.(IVU.LE.67)) THEN
	    LU(IVU)=LU(IVU)*(-1.D-16)
	  ELSEIF ((IVU.GE.68).AND.(IVU.LE.69)) THEN
	    LU(IVU)=LU(IVU)*(-1.D-15)
	  ENDIF
	  IF (IVU.LE.14) THEN
	    MU(IVU)=MU(IVU)*(-1.D-25)
	  ELSEIF ((IVU.GE.15).AND.(IVU.LE.28)) THEN
	    MU(IVU)=MU(IVU)*(-1.D-24)
	  ELSEIF ((IVU.GE.29).AND.(IVU.LE.41)) THEN
	    MU(IVU)=MU(IVU)*(-1.D-23)
	  ELSEIF ((IVU.GE.42).AND.(IVU.LE.52)) THEN
	    MU(IVU)=MU(IVU)*(-1.D-22)
	  ELSEIF ((IVU.GE.53).AND.(IVU.LE.60)) THEN
	    MU(IVU)=MU(IVU)*(-1.D-21)
	  ELSEIF ((IVU.GE.61).AND.(IVU.LE.66)) THEN
	    MU(IVU)=MU(IVU)*(-1.D-20)
	  ELSEIF ((IVU.GE.67).AND.(IVU.LE.69)) THEN
	    MU(IVU)=MU(IVU)*(-1.D-19)
	  ENDIF
20	  CONTINUE
C
C  READ IN FCF VALUES FROM FILE fcfioded
	DO 25 IVU=0,69
	  IF (((IVU.GE.0).AND.(IVU.LE.29)).OR.
     &	      ((IVU.GE.31).AND.(IVU.LE.41)).OR.
     &	      (IVU.EQ.43)) THEN
	    LJFMAX(IVU)=8
	  ELSEIF ((IVU.EQ.30).OR.(IVU.EQ.42).OR.
     &            ((IVU.GE.44).AND.(IVU.LE.46)).OR.
     &		  ((IVU.GE.48).AND.(IVU.LE.50))) THEN
	    LJFMAX(IVU)=7
	  ELSEIF ((IVU.EQ.47).OR.(IVU.EQ.51).OR.(IVU.EQ.52).OR.
     &	          (IVU.EQ.54).OR.(IVU.EQ.57)) THEN
	    LJFMAX(IVU)=6
	  ELSEIF ((IVU.EQ.53).OR.(IVU.EQ.55).OR.(IVU.EQ.56)) THEN
	    LJFMAX(IVU)=5
	  ELSEIF ((IVU.GE.59).AND.(IVU.LE.63)) THEN
	    LJFMAX(IVU)=4
	  ELSEIF ((IVU.EQ.58).OR.(IVU.EQ.64).OR.
     &		  ((IVU.GE.66).AND.(IVU.LE.68))) THEN
	    LJFMAX(IVU)=3
	  ELSEIF ((IVU.EQ.65).OR.(IVU.EQ.69)) THEN
	    LJFMAX(IVU)=2
	  ENDIF
25	CONTINUE
	OPEN(UNIT=10,FILE='fcfioded',STATUS='OLD')
	DO 40 IVL=0,19
	  DO 35 IVU=0,69
	    DO 30 LJ=0,LJFMAX(IVU)
	      READ(10,27)FACTOR(IVU,IVL,LJ),EXP
27	      FORMAT(44X,F4.4,1X,F3.0)
	      FACTOR(IVU,IVL,LJ)=FACTOR(IVU,IVL,LJ)*(10.**(-1.*EXP))
30	    CONTINUE
	    READ(10,*)
35	  CONTINUE
	  READ(10,*)
40	CONTINUE
	CLOSE(10)
C
C  INITIALIZE ENERGY STORAGE VARIABLES
	DO 70 IVL=0,19
	  DO 60 IVU=0,69
	    DO 50 J=0,200
	      ER(IVU,IVL,J)=0.
	      EP(IVU,IVL,J)=0.
50	    CONTINUE
60	  CONTINUE
70	CONTINUE
	DO 80 N=1,50000
	  ENERGY(N)=0.
	  KVU(N)=100
	  KVL(N)=100
	  KJ(N)=500
	  RORP(N)='X'
	  FCF(N)=0.
	  DELTAEQQ(N)=0.
	  DELTAC(N)=0.
80	CONTINUE
C
C  CALCULATE MAXIMUM J VALUES - LIMITED BY DISOCCIATION OF B STATE
	DO 100 IVU=0,69
	  JMAX(IVU)=INT((-4.375*(FLOAT(IVU)))+375.)
	  IF (JMAX(IVU).GT.200) THEN
	    JMAX(IVU)=200
	  ENDIF
100	CONTINUE
C
	M=0
	DO 130 IVL=0,19
	  DO 120 IVU=0,69
	    DO 110 J=0,JMAX(IVU)
	      ALPHA = FLOAT(J+1)*FLOAT(J+2)
	      BETA = FLOAT(J)*FLOAT(J-1)
	      GAMMA = FLOAT(J)*FLOAT(J+1)
	      ER(IVU,IVL,J)=EU(IVU)+BU(IVU)*ALPHA-DU(IVU)*(ALPHA**2)
     &			   +HU(IVU)*(ALPHA**3)+LU(IVU)*(ALPHA**4)
     &			   +MU(IVU)*(ALPHA**5)-EL(IVL)-BL(IVL)*GAMMA
     &			   +DL(IVL)*(GAMMA**2)-HL(IVL)*(GAMMA**3)
	      EP(IVU,IVL,J)=EU(IVU)+BU(IVU)*BETA-DU(IVU)*(BETA**2)
     &			   +HU(IVU)*(BETA**3)+LU(IVU)*(BETA**4)
     &			   +MU(IVU)*(BETA**5)-EL(IVL)-BL(IVL)*GAMMA
     &			   +DL(IVL)*(GAMMA**2)-HL(IVL)*(GAMMA**3)
 	      IF ((ER(IVU,IVL,J).GE. WNLO).AND.
     &		  (ER(IVU,IVL,J).LE. WNHI)) THEN
		M=M+1
	        ENERGY(M)=ER(IVU,IVL,J)
		KVU(M)=IVU
		KVL(M)=IVL
		KJ(M)=J
		RORP(M)='R'
		FCF(M)=FCFFUNCTION(IVU,IVL,J,RORP(M))
		GU=EU(IVU)-15661.9409
	        EROT=BU(IVU)*ALPHA-DU(IVU)*(ALPHA**2.)
     &          +HU(IVU)*(ALPHA**3.)
     &	        +LU(IVU)*(ALPHA**4.)+MU(IVU)*(ALPHA**5.)
		ETOT=GU+EROT
		DELTAEQQ(M)=1973.0307-(0.0209608*GU)
     &			-((1.44052*EROT)/(4381.212-ETOT))
		DELTAEQQ(M)=DELTAEQQ(M)/30000.
		DELTAC(M)=(42993.4/((4381.212-GU)**0.82575))-28.7532
		DELTAC(M)=DELTAC(M)/3.E7
	      ENDIF
	      IF ((EP(IVU,IVL,J).GE. WNLO).AND.
     &		  (EP(IVU,IVL,J).LE. WNHI)) THEN
		M=M+1
		ENERGY(M)=EP(IVU,IVL,J)
		KVU(M)=IVU
		KVL(M)=IVL
		KJ(M)=J
		RORP(M)='P'
		FCF(M)=FCFFUNCTION(IVU,IVL,J,RORP(M))
		GU=EU(IVU)-15661.9409
		EROT=BU(IVU)*BETA-DU(IVU)*(BETA**2.)+HU(IVU)*(BETA**3.)
     &		     +LU(IVU)*(BETA**4.)+MU(IVU)*(BETA**5.)
		ETOT=GU+EROT
		DELTAEQQ(M)=1973.0307-(0.0209608*GU)
     &			-((1.44052*EROT)/(4381.212-ETOT))
		DELTAEQQ(M)=DELTAEQQ(M)/30000.
		DELTAC(M)=(42993.4/((4381.212-GU)**0.82575))-28.7532
		DELTAC(M)=DELTAC(M)/3.E7
	      ENDIF
110	    CONTINUE
120	  CONTINUE
130	CONTINUE
C
C  PRINT TO OUTPUT FILE IN ORDER OF LOWEST WAVENUMBER TO HIGHEST WAVENUMBER
	OPEN(UNIT=40,FILE=FILNAM)
	WRITE(40,*)M
	OLDEN=WNLO
	CURENTEN=WNHI
	NC=0
	DO 220 L=1,M
	  DO 200 N=1,M
	    IF ((ENERGY(N).GT.OLDEN)
     &         .AND.(ENERGY(N).LT.CURENTEN)) THEN
	      CURENTEN=ENERGY(N)
	      NC=N
	    ENDIF
200	  CONTINUE
	  WRITE(40,210)ENERGY(NC),KVU(NC),KVL(NC),KJ(NC),RORP(NC),
     &	FCF(NC),DELTAEQQ(NC),DELTAC(NC)
210	  FORMAT(F10.4,' ',I2,' ',I2,' ',I3,' ',A1,' ',E11.4,' ',E13.6,
     &		 ' ',E13.6)
	  OLDEN=ENERGY(NC)
	  CURENTEN=WNHI
	  NC=0
220	CONTINUE
	CLOSE(40)
C
	STOP
	END

******************************************************************************
	FUNCTION FCFFUNCTION(IVU,IVL,J,PORR)
C  THIS FUNCTION DETERMINES THE FCF VALUE FOR GIVEN IVU, IVL, AND J VALUES, 
C  BY EXTRAPOLATING OR INTERPOLATING FROM VALUES IN THE ARRAY FACTOR WHICH
C  WERE READ IN FROM THE FILE fcfioded IN THE MAIN PROGRAM
C
	INTEGER IVU,IVL,J,LJFMAX(0:69),LJ1,LJ2
	REAL RJ1,RJ2,RJ3,FUNCTION
	DOUBLE PRECISION FACTOR(0:69,0:19,0:8)
	CHARACTER*1 PORR
C
	COMMON/FRCOND/FACTOR,LJFMAX
C
C  IF J IS GREATER THAN LJFMAX*25 THEN EXTRAPOLATE.  IF J IS LESS THAN
C  LJFMAX*25 THEN INTERPOLATE.
	IF (J.GE.(25*LJFMAX(IVU))) THEN
	  LJ1=LJFMAX(IVU)-1
	  LJ2=LJFMAX(IVU)
	  RJ1=25.*FLOAT(LJFMAX(IVU)-1)
	  RJ2=25.*FLOAT(LJFMAX(IVU))
	  RJ3=FLOAT(J)
	  FUNCTION=FACTOR(IVU,IVL,LJ2)+
     &       ((FACTOR(IVU,IVL,LJ2)-FACTOR(IVU,IVL,LJ1))
     &		          /(RJ2*(RJ2+1.)-RJ1*(RJ1+1.)))*
     &       (RJ3*(RJ3+1.)-RJ2*(RJ2+1.))
C  IF FCF VALUE CAME OUT NEGATIVE WHEN EXTRAPOLATING, THEN USE FCF VALUE 
C  FOR HIGHEST AVAILABLE J VALUE
	  IF (FUNCTION.LE.0.) THEN
	    FUNCTION=FACTOR(IVU,IVL,LJ2)
	    WRITE(*,10)PORR,J,IVU,IVL
10	    FORMAT('THE ',A1,I3,'(',I2,'-',I2,
     &  ') LINE HAS BEEN ASSIGNED AN FCF VALUE')
	    WRITE(*,20)(LJ2*25),IVU,IVL
20	    FORMAT('EQUAL TO THAT FOR THE LINE R OR P ',I3,
     &  '(',I2,'-',I2,') SINCE')
	    WRITE(*,30)
30	    FORMAT('THE VALUE OBTAINED BY EXTRAPOLATION', 
     &  ' WAS LESS THAN ZERO')
	    WRITE(*,*)
	  ENDIF
	ELSE
	  LJ1=J/25
	  LJ2=LJ1+1
	  RJ1=25.*FLOAT(LJ1)
	  RJ2=25.*FLOAT(LJ2)
	  RJ3=FLOAT(J)
	  FUNCTION=FACTOR(IVU,IVL,LJ1)+
     &	     ((FACTOR(IVU,IVL,LJ2)-FACTOR(IVU,IVL,LJ1))
     &                    /(RJ2*(RJ2+1.)-RJ1*(RJ1+1.)))*
     &       (RJ3*(RJ3+1.)-RJ1*(RJ1+1.))
	ENDIF
C
	FCFFUNCTION=FUNCTION
C
	RETURN
	END